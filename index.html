<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="https://www.apachefriends.org/images/xampp-logo-ac950edf.svg"
    />
    <title>Document</title>
  </head>
  <body>

    
<!--     
<?php
require_once 'Donor.php';
require_once 'Donation.php';
session_start();

if (!isset($_SESSION['donors'])) {
    $_SESSION['donors'] = [];
}
if (!isset($_SESSION['donations'])) {
    $_SESSION['donations'] = [];
}

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    if (isset($_POST['clear_data'])) {
        session_destroy();
        header("Location: index.php");
        exit();
    }
    
    if (isset($_POST['register_donor'])) {
        $firstName = trim($_POST['first_name']);
        $lastName  = trim($_POST['last_name']);
        if (!empty($firstName) && !empty($lastName)) {
            $donorId = count($_SESSION['donors']) + 1;
            $_SESSION['donors'][$donorId] = new Donor($donorId, $firstName, $lastName);
        }
        header("Location: index.php");
        exit();
    }
    
    if (isset($_POST['submit_donation'])) {
        $donorId = $_POST['donor_id'];
        $amount  = floatval($_POST['amount']);
        if (!empty($donorId) && $amount > 0) {
            $donationId = count($_SESSION['donations']) + 1;
            $_SESSION['donations'][] = new Donation($donationId, $donorId, $amount);
        }
        header("Location: index.php");
        exit();
    }
}
?>

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        table, th, td {
            width: 900px;
            border: 1px solid #000;
            border-collapse: collapse;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: lightgrey;
        }
        form { 
            margin-bottom: 20px; }
        h2 { 
            margin-bottom: 5px; }
    </style>
</head>
<body>
    <h1>Donation Tracking System</h1>
    <h2>Donor Registration</h2><br>
    <form method="POST" action="index.php">
        <label for="first_name">First Name:</label>
        <input type="text" name="first_name" id="first_name" placeholder="Enter first name" required><br><br>
        <label for="last_name">Last Name:</label>
        <input type="text" name="last_name" id="last_name" placeholder="Enter last name" required><br><br>
        <input type="submit" name="register_donor" value="Register Donor" onclick="return alert('Donor registered successfully. Please proceed to select donor dropdown.')">
    </form>
    
    <h2>Donation Entry</h2><br>
    <form method="POST" action="index.php">
        <label for="donor_id">Select Donor:</label>
        <select name="donor_id" id="donor_id" required>
            <option value="">-- Select Donor --</option>
            <?php foreach($_SESSION['donors'] as $donor): ?>
                <option value="<?php echo $donor->getDonorId(); ?>">
                    <?php echo $donor->getFullName(); ?>
                </option>
            <?php endforeach; ?>
        </select><br><br>
        <label for="amount">Donation Amount:</label>
        <input type="number" name="amount" placeholder="Enter donation amount" required><br><br>
        <input type="submit" name="submit_donation" value="Submit Donation" onclick="return alert('Donation submitted successfully!')">
    </form>
    
    <h2>Donation Records</h2>
    <table>
        <thead>
            <tr>
                <th>Donor ID</th>
                <th>Donor Name</th>
                <th>Donation ID</th>
                <th>Amount</th>
            </tr>
        </thead>
        <tbody>
            <?php 
            $grandTotal = 0;
            foreach ($_SESSION['donors'] as $donorId => $donor):
                $donationsForDonor = array_filter($_SESSION['donations'], function($donation) use ($donorId) {
                    return $donation->getDonorId() == $donorId;
                });
                
                if (count($donationsForDonor) > 0) {
                    $rowspan = count($donationsForDonor);
                    $firstRow = true;
                    foreach ($donationsForDonor as $donation):
                        if ($firstRow): ?>
                            <tr>
                                <td rowspan="<?php echo $rowspan; ?>"><?php echo $donor->getDonorId(); ?></td>
                                <td rowspan="<?php echo $rowspan; ?>"><?php echo $donor->getFullName(); ?></td>
                                <td><?php echo $donation->getDonationId(); ?></td>
                                <td><?php echo number_format($donation->getAmount(), 2); ?></td>
                            </tr>
                        <?php 
                            $firstRow = false;
                        else: ?>
                            <tr>
                                <td><?php echo $donation->getDonationId(); ?></td>
                                <td><?php echo number_format($donation->getAmount(), 2); ?></td>
                            </tr>
                        <?php 
                        endif;
                        $grandTotal += $donation->getAmount();
                    endforeach;
                }
            endforeach;
            ?>
            <tr>
                <th></th>
                <th><strong>Grand Total</strong></th>
                <th></th>
                <th><strong><?php echo number_format($grandTotal, 2); ?></strong></th>
            </tr>
        </tbody>
    </table>
    
    <form method="POST" action="index.php">
        <br>
        <button type="submit" name="clear_data" onclick="return confirm('Are you sure you want to clear all data?')">Clear All Data</button>
    </form>
</body>
</html>

	  

	  <?php
class Donation {
    private $donationId;
    private $donorId;
    private $amount;

    public function __construct($donationId, $donorId, $amount) {
        $this->donationId = $donationId;
        $this->donorId = $donorId;
        $this->amount = $amount;
    }

    public function getDonationId() {
        return $this->donationId;
    }

    public function getDonorId() {
        return $this->donorId;
    }

    public function getAmount() {
        return $this->amount;
    }

    public function getDonationInfo() {
        return "Donation ID: " . $this->donationId . " | Amount: $" . number_format($this->amount, 2);
    }
}
?>


	<?php
class Donor {
    private $donorId;
    private $firstName;
    private $lastName;

    public function __construct($donorId, $firstName, $lastName) {
        $this->donorId = $donorId;
        $this->firstName = $firstName;
        $this->lastName = $lastName;
    }

    public function getDonorId() {
        return $this->donorId;
    }

    public function getFullName() {
        return $this->firstName . ' ' . $this->lastName;
    }
}
?>
	  
	  -->
  </body>
</html>
